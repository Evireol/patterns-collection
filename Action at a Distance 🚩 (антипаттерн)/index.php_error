<?php
// ===== –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï =====
$user = null; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã

// ===== –§–£–ù–ö–¶–ò–Ø 1: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function authenticateUser(string $login, string $password): bool {
    global $user;

    // –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    if ($login === 'admin' && $password === '123') {
        $user = [
            'id' => 1,
            'name' => '–ê–¥–º–∏–Ω',
            'email' => 'admin@example.com',
            'role' => 'admin'
        ];
        return true;
    }

    $user = null;
    return false;
}

// ===== –§–£–ù–ö–¶–ò–Ø 2: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email, –ù–û –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ $user!
function sendWelcomeEmail(): void {
    global $user;

    if ($user === null) {
        throw new Exception("–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å email: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω!");
    }

    echo "üìß –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∏—Å—å–º–æ –Ω–∞ {$user['email']}...\n";
    // mail($user['email'], '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!', '...');
}

// ===== –§–£–ù–ö–¶–ò–Ø 3: –ª–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è, –¢–û–ñ–ï –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ $user
function logAction(string $action): void {
    global $user;

    $userName = $user ? $user['name'] : '–ì–æ—Å—Ç—å';
    echo "[LOG] {$userName} –≤—ã–ø–æ–ª–Ω–∏–ª: {$action}\n";
}

// ===== –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê =====
logAction("–ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞"); // ‚Üê –ì–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–∏–ª: –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞

if (authenticateUser('admin', '123')) {
    logAction("–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥"); // ‚Üê –ê–¥–º–∏–Ω –≤—ã–ø–æ–ª–Ω–∏–ª: –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
    sendWelcomeEmail();         // ‚Üê –†–∞–±–æ—Ç–∞–µ—Ç! –ù–æ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ authenticateUser –∏–∑–º–µ–Ω–∏–ª $user
} else {
    echo "–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞\n";
}

// –ê —á—Ç–æ, –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ –≤ –¥—Ä—É–≥–æ–º —Ñ–∞–π–ª–µ –≤—ã–∑–æ–≤—É—Ç:
$user = ['name' => '–•–∞–∫–µ—Ä', 'email' => 'hacker@evil.com'];
// ‚Üë –¢–µ–ø–µ—Ä—å sendWelcomeEmail() –æ—Ç–ø—Ä–∞–≤–∏—Ç –ø–∏—Å—å–º–æ –•–ê–ö–ï–†–£ ‚Äî –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è!